package com.aws.sqs.service;

import org.apache.juli.logging.Log;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Component;

import com.amazonaws.services.sqs.model.SendMessageResult;
import com.aws.sqs.client.SqsClient;

import lombok.extern.slf4j.Slf4j;


@Component
@Slf4j
public class MessagePublisherService {
	
	private int  i = 0;
	@Autowired 
	private SqsClient client;
	
	@Scheduled(fixedRate = 1000)
	private void sendMessage() {
		SendMessageResult result = client.getSqsClient().
				sendMessage(client.getUrl(),"hello" + i);
		Log.info("Published Message {}", result.getMessageId());
		i++;
	}
}
